<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Forge - Project Generator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c7c7cc; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1aa; 
        }

        /* Smooth transitions for height changes */
        .slide-content {
            transition: all 0.3s ease-in-out;
            overflow: hidden;
            max-height: 0;
            opacity: 0;
        }
        .slide-content.open {
            max-height: 1000px; /* Arbitrary large height */
            opacity: 1;
        }

        /* Radio Card Selection Styling */
        input[type="radio"]:checked + div {
            border-color: #4f46e5;
            background-color: #eef2ff;
        }
        input[type="radio"]:checked + div .check-icon {
            opacity: 1;
            transform: scale(1);
        }

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #68D391;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #68D391;
        }
    </style>
</head>
<body class="text-gray-800 antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-20">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-indigo-600 text-white p-2 rounded-lg shadow-sm">
                    <i class="fa-solid fa-code-branch text-xl"></i>
                </div>
                <h1 class="text-xl font-bold text-gray-900 tracking-tight">API<span class="text-indigo-600">Forge</span></h1>
            </div>
            <button onclick="resetForm()" class="text-sm text-gray-500 hover:text-red-500 transition-colors">
                <i class="fa-solid fa-rotate-left mr-1"></i> Reset
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        
        <form id="projectForm" onsubmit="handleGenerate(event)">
            
            <!-- Section 1: General Details -->
            <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-circle-info text-indigo-500"></i> General Details
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
                    <div class="md:col-span-6">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Project Name</label>
                        <input type="text" id="projectName" placeholder="my-awesome-api" required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                    </div>
                    <div class="md:col-span-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Port</label>
                        <input type="number" id="port" value="3000" required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                    </div>
                    <div class="md:col-span-12">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="description" rows="2" placeholder="A brief description of what this API does..."
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all"></textarea>
                    </div>
                </div>
            </section>

            <!-- Section 2: Tech Stack & Database -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                
                <!-- Tech Stack -->
                <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-layer-group text-indigo-500"></i> Tech Stack
                    </h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Node Option -->
                        <label class="cursor-pointer relative">
                            <input type="radio" name="techStack" value="nodejs" class="sr-only" checked>
                            <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-indigo-300 transition-all h-full flex flex-col items-center justify-center gap-2 group">
                                <i class="fa-brands fa-node text-4xl text-green-600 mb-1"></i>
                                <span class="font-medium text-gray-700">Node.js</span>
                                <i class="fa-solid fa-circle-check absolute top-2 right-2 text-indigo-600 opacity-0 transform scale-50 transition-all check-icon"></i>
                            </div>
                        </label>
                        <!-- ASP.NET Option -->
                        <label class="cursor-pointer relative">
                            <input type="radio" name="techStack" value="aspnet" class="sr-only">
                            <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-indigo-300 transition-all h-full flex flex-col items-center justify-center gap-2 group">
                                <i class="fa-brands fa-microsoft text-4xl text-blue-600 mb-1"></i>
                                <span class="font-medium text-gray-700">ASP.NET Core</span>
                                <i class="fa-solid fa-circle-check absolute top-2 right-2 text-indigo-600 opacity-0 transform scale-50 transition-all check-icon"></i>
                            </div>
                        </label>
                    </div>
                </section>

                <!-- Database -->
                <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-database text-indigo-500"></i> Database
                    </h2>
                    <div class="space-y-3">
                        <label class="cursor-pointer relative block">
                            <input type="radio" name="database" value="postgres" class="sr-only" checked>
                            <div class="border border-gray-200 rounded-lg p-3 hover:border-indigo-300 transition-all flex items-center gap-3">
                                <div class="bg-blue-100 p-2 rounded-md"><i class="fa-solid fa-elephant text-blue-600"></i></div>
                                <div>
                                    <div class="font-medium text-gray-900">PostgreSQL</div>
                                    <div class="text-xs text-gray-500">Relational robustness</div>
                                </div>
                                <i class="fa-solid fa-circle-check ml-auto text-indigo-600 opacity-0 transform scale-50 transition-all check-icon"></i>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative block">
                            <input type="radio" name="database" value="mongodb" class="sr-only">
                            <div class="border border-gray-200 rounded-lg p-3 hover:border-indigo-300 transition-all flex items-center gap-3">
                                <div class="bg-green-100 p-2 rounded-md"><i class="fa-solid fa-leaf text-green-600"></i></div>
                                <div>
                                    <div class="font-medium text-gray-900">MongoDB</div>
                                    <div class="text-xs text-gray-500">NoSQL document store</div>
                                </div>
                                <i class="fa-solid fa-circle-check ml-auto text-indigo-600 opacity-0 transform scale-50 transition-all check-icon"></i>
                            </div>
                        </label>

                        <label class="cursor-pointer relative block">
                            <input type="radio" name="database" value="localstorage" class="sr-only">
                            <div class="border border-gray-200 rounded-lg p-3 hover:border-indigo-300 transition-all flex items-center gap-3">
                                <div class="bg-yellow-100 p-2 rounded-md"><i class="fa-solid fa-hard-drive text-yellow-600"></i></div>
                                <div>
                                    <div class="font-medium text-gray-900">Local Storage / JSON</div>
                                    <div class="text-xs text-gray-500">File-based persistence</div>
                                </div>
                                <i class="fa-solid fa-circle-check ml-auto text-indigo-600 opacity-0 transform scale-50 transition-all check-icon"></i>
                            </div>
                        </label>
                    </div>
                </section>
            </div>

            <!-- Section 3: Security Configuration -->
            <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-shield-halved text-indigo-500"></i> Security
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Auth Toggle -->
                    <div class="flex items-start justify-between bg-gray-50 p-4 rounded-lg">
                        <div>
                            <h3 class="font-medium text-gray-900">Authentication</h3>
                            <p class="text-sm text-gray-500 mt-1">Implement user login and route protection.</p>
                        </div>
                        <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                            <input type="checkbox" name="auth" id="authToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-gray-300 transition-all duration-300" onclick="toggleEncryptionOption()">
                            <label for="authToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer transition-colors duration-300"></label>
                        </div>
                    </div>

                    <!-- Encryption Toggle (Dependent on Auth) -->
                    <div id="encryptionContainer" class="flex items-start justify-between bg-gray-50 p-4 rounded-lg opacity-50 pointer-events-none transition-opacity">
                        <div>
                            <h3 class="font-medium text-gray-900">Encryption</h3>
                            <p class="text-sm text-gray-500 mt-1">Encrypt sensitive data and payloads.</p>
                        </div>
                        <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                            <input type="checkbox" name="encryption" id="encryptionToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-gray-300 transition-all duration-300" disabled>
                            <label for="encryptionToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer transition-colors duration-300"></label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: CORS Configuration -->
            <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h2 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
                        <i class="fa-solid fa-globe text-indigo-500"></i> CORS Configuration
                    </h2>
                    <div class="flex items-center gap-2">
                        <span class="text-sm text-gray-600" id="corsStatusText">Disabled</span>
                        <div class="relative inline-block w-10 align-middle select-none">
                            <input type="checkbox" id="corsToggle" onchange="toggleCorsSection()" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer border-gray-300 transition-all duration-300 top-0.5">
                            <label for="corsToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                        </div>
                    </div>
                </div>

                <div id="corsContent" class="slide-content">
                    <div class="pt-4 mt-2 border-t border-gray-100">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Allowed Origins</label>
                        <div class="flex gap-2 mb-3">
                            <input type="text" id="newDomain" placeholder="https://example.com" 
                                class="flex-grow px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 outline-none text-sm">
                            <button type="button" onclick="addDomain()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                                <i class="fa-solid fa-plus"></i> Add
                            </button>
                        </div>
                        <div id="domainList" class="flex flex-wrap gap-2">
                            <!-- Dynamic domains will appear here -->
                            <div class="text-sm text-gray-400 italic" id="emptyDomainsMsg">No specific domains added (Allow All *)</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Static Folders -->
            <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8">
                <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-folder-open text-indigo-500"></i> Static Assets
                </h2>
                
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3">
                        <div>
                            <label class="block text-xs font-semibold text-gray-500 uppercase mb-1">Local Folder Name</label>
                            <input type="text" id="folderName" placeholder="e.g., uploads" 
                                class="w-full px-3 py-2 rounded-md border border-gray-300 text-sm focus:ring-1 focus:ring-indigo-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-500 uppercase mb-1">Route Path</label>
                            <div class="flex">
                                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-100 text-gray-500 text-sm">/</span>
                                <input type="text" id="folderPath" placeholder="static/files" 
                                    class="w-full px-3 py-2 rounded-r-md border border-gray-300 text-sm focus:ring-1 focus:ring-indigo-500 outline-none">
                            </div>
                        </div>
                    </div>
                    <button type="button" onclick="addStaticFolder()" class="w-full sm:w-auto text-sm bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 hover:text-indigo-600 transition-colors shadow-sm font-medium">
                        <i class="fa-solid fa-plus mr-1"></i> Map Folder
                    </button>
                </div>

                <div class="overflow-hidden rounded-lg border border-gray-200 hidden" id="staticTableContainer">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Folder</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Public Route</th>
                                <th class="px-6 py-3 text-right">Action</th>
                            </tr>
                        </thead>
                        <tbody id="staticFolderList" class="bg-white divide-y divide-gray-200">
                            <!-- Dynamic rows -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Action Bar -->
            <div class="sticky bottom-0 bg-white/90 backdrop-blur-md border-t border-gray-200 p-4 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 flex justify-end gap-3 z-10">
                <button type="button" class="px-6 py-2.5 rounded-lg text-gray-700 font-medium hover:bg-gray-100 transition-colors">
                    Preview
                </button>
                <button type="submit" class="px-8 py-2.5 rounded-lg bg-indigo-600 text-white font-medium hover:bg-indigo-700 shadow-lg shadow-indigo-500/30 transition-all transform hover:-translate-y-0.5">
                    Generate Project
                </button>
            </div>

        </form>
    </main>

    <!-- Modal for Result -->
    <div id="resultModal" class="fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all scale-95 opacity-0" id="modalContent">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                <div>
                    <h3 class="text-xl font-bold text-gray-900">Project Configuration</h3>
                    <p class="text-sm text-gray-500">Ready to scaffold your API</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-0 overflow-auto bg-gray-50 flex-grow relative group">
                <button onclick="copyJson()" class="absolute top-4 right-4 bg-white border border-gray-200 text-gray-600 px-3 py-1 rounded text-xs font-medium hover:bg-indigo-50 hover:text-indigo-600 shadow-sm opacity-0 group-hover:opacity-100 transition-opacity">
                    Copy JSON
                </button>
                <pre class="text-sm text-gray-800 p-6 font-mono leading-relaxed" id="jsonOutput"></pre>
            </div>
            <div class="p-6 border-t border-gray-100 flex justify-end gap-3 bg-white rounded-b-2xl">
                <button onclick="closeModal()" class="px-5 py-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors">Close</button>
                <button onclick="closeModal()" class="px-5 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 shadow-md">
                    <i class="fa-solid fa-download mr-2"></i>Download Config
                </button>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let corsDomains = [];
        let staticFolders = [];

        // --- Logic: Authentication & Encryption ---
        function toggleEncryptionOption() {
            const authChecked = document.getElementById('authToggle').checked;
            const encryptContainer = document.getElementById('encryptionContainer');
            const encryptToggle = document.getElementById('encryptionToggle');
            
            if (authChecked) {
                encryptContainer.classList.remove('opacity-50', 'pointer-events-none');
                encryptToggle.disabled = false;
            } else {
                encryptContainer.classList.add('opacity-50', 'pointer-events-none');
                encryptToggle.disabled = true;
                encryptToggle.checked = false;
            }
        }

        // --- Logic: CORS ---
        function toggleCorsSection() {
            const isChecked = document.getElementById('corsToggle').checked;
            const content = document.getElementById('corsContent');
            const statusText = document.getElementById('corsStatusText');
            
            if (isChecked) {
                content.classList.add('open');
                statusText.textContent = 'Enabled';
                statusText.classList.add('text-indigo-600', 'font-medium');
            } else {
                content.classList.remove('open');
                statusText.textContent = 'Disabled';
                statusText.classList.remove('text-indigo-600', 'font-medium');
            }
        }

        function addDomain() {
            const input = document.getElementById('newDomain');
            const domain = input.value.trim();
            
            if (domain && !corsDomains.includes(domain)) {
                corsDomains.push(domain);
                renderDomains();
                input.value = '';
            }
        }

        function removeDomain(domain) {
            corsDomains = corsDomains.filter(d => d !== domain);
            renderDomains();
        }

        function renderDomains() {
            const container = document.getElementById('domainList');
            const emptyMsg = document.getElementById('emptyDomainsMsg');
            
            container.innerHTML = '';
            
            if (corsDomains.length === 0) {
                container.appendChild(emptyMsg);
                emptyMsg.style.display = 'block';
                return;
            } else {
                emptyMsg.style.display = 'none';
            }

            corsDomains.forEach(domain => {
                const tag = document.createElement('div');
                tag.className = 'bg-indigo-50 border border-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm flex items-center gap-2 animate-[fadeIn_0.2s_ease-out]';
                tag.innerHTML = `
                    <span>${domain}</span>
                    <button type="button" onclick="removeDomain('${domain}')" class="text-indigo-400 hover:text-red-500 focus:outline-none">
                        <i class="fa-solid fa-xmark"></i>
                    </button>
                `;
                container.appendChild(tag);
            });
        }

        // --- Logic: Static Folders ---
        function addStaticFolder() {
            const nameInput = document.getElementById('folderName');
            const pathInput = document.getElementById('folderPath');
            
            const name = nameInput.value.trim();
            const path = pathInput.value.trim();

            if (name && path) {
                // Prevent duplicates based on route
                if (!staticFolders.some(f => f.path === path)) {
                    staticFolders.push({ name, path });
                    renderStaticFolders();
                    nameInput.value = '';
                    pathInput.value = '';
                } else {
                    alert('Route path already exists!');
                }
            }
        }

        function removeFolder(index) {
            staticFolders.splice(index, 1);
            renderStaticFolders();
        }

        function renderStaticFolders() {
            const tbody = document.getElementById('staticFolderList');
            const tableContainer = document.getElementById('staticTableContainer');
            
            tbody.innerHTML = '';

            if (staticFolders.length > 0) {
                tableContainer.classList.remove('hidden');
                staticFolders.forEach((folder, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            <i class="fa-regular fa-folder text-gray-400 mr-2"></i> ${folder.name}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <span class="bg-gray-100 text-gray-600 px-2 py-0.5 rounded text-xs font-mono">/${folder.path}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button type="button" onclick="removeFolder(${index})" class="text-red-500 hover:text-red-700 transition-colors">
                                <i class="fa-regular fa-trash-can"></i>
                            </button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } else {
                tableContainer.classList.add('hidden');
            }
        }

        // --- Logic: Generate & Modal ---
        function handleGenerate(e) {
            e.preventDefault();

            // Collect Data
            const formData = {
                general: {
                    name: document.getElementById('projectName').value || 'untitled-project',
                    port: parseInt(document.getElementById('port').value) || 3000,
                    description: document.getElementById('description').value
                },
                techStack: document.querySelector('input[name="techStack"]:checked').value,
                database: document.querySelector('input[name="database"]:checked').value,
                security: {
                    authentication: document.getElementById('authToggle').checked,
                    encryption: document.getElementById('encryptionToggle').checked
                },
                cors: {
                    enabled: document.getElementById('corsToggle').checked,
                    allowedOrigins: document.getElementById('corsToggle').checked ? corsDomains : []
                },
                staticAssets: staticFolders
            };

            // Display
            const jsonStr = JSON.stringify(formData, null, 2);
            document.getElementById('jsonOutput').textContent = jsonStr;
            
            // Show Modal
            const modal = document.getElementById('resultModal');
            const modalContent = document.getElementById('modalContent');
            modal.classList.remove('hidden');
            
            // Trigger animation
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('resultModal');
            const modalContent = document.getElementById('modalContent');
            
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }

        function copyJson() {
            const text = document.getElementById('jsonOutput').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('button[onclick="copyJson()"]');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = originalText, 2000);
            });
        }

        function resetForm() {
            if(confirm("Are you sure you want to reset all fields?")) {
                document.getElementById('projectForm').reset();
                corsDomains = [];
                staticFolders = [];
                renderDomains();
                renderStaticFolders();
                toggleCorsSection();
                toggleEncryptionOption();
            }
        }
    </script>
</body>
</html>